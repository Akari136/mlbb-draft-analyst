/**
 * MtTrack
 * version: 0.13.5
 */
(function(E,v){typeof exports=="object"&&typeof module<"u"?module.exports=v():typeof define=="function"&&define.amd?define(v):(E=typeof globalThis<"u"?globalThis:E||self,E.MtTrack=v())})(this,function(){"use strict";var Si=Object.defineProperty,Ti=Object.defineProperties;var bi=Object.getOwnPropertyDescriptors;var kr=Object.getOwnPropertySymbols;var Oi=Object.prototype.hasOwnProperty,Ii=Object.prototype.propertyIsEnumerable;var pt=(E,v,x)=>v in E?Si(E,v,{enumerable:!0,configurable:!0,writable:!0,value:x}):E[v]=x,g=(E,v)=>{for(var x in v||(v={}))Oi.call(v,x)&&pt(E,x,v[x]);if(kr)for(var x of kr(v))Ii.call(v,x)&&pt(E,x,v[x]);return E},S=(E,v)=>Ti(E,bi(v));var d=(E,v,x)=>(pt(E,typeof v!="symbol"?v+"":v,x),x);function E(t){return{all:t=t||new Map,on:function(e,r){var n=t.get(e);n?n.push(r):t.set(e,[r])},off:function(e,r){var n=t.get(e);n&&(r?n.splice(n.indexOf(r)>>>0,1):t.set(e,[]))},emit:function(e,r){var n=t.get(e);n&&n.slice().map(function(o){o(r)}),(n=t.get("*"))&&n.slice().map(function(o){o(e,r)})}}}function v(t,e){return g(g({},t),e)}const x="_mtt",ue="ququeCache",le="fp",ht="uuid",gt="sessionId",mt="trackOptions",$e=class $e{constructor(e="localStorage",r){d(this,"storageInterface");this.source=e,this.scope=r,this.storageInterface=window[e]}static getInstance(e="localStorage"){return this.singletons[e]||(this.singletons[e]=new $e(e)),this.singletons[e]}set(e,r){var n;if(this.scope){const o=(n=this._get(this.scope))!=null?n:{};o[e]=r,this._set(this.scope,o);return}this._set(e,r)}_set(e,r){this.storageInterface.setItem(e,JSON.stringify(r))}get(e,r){var n,o;return(o=this.scope?(n=this._get(this.scope))==null?void 0:n[e]:this._get(e))!=null?o:r}_get(e){const r=this.storageInterface.getItem(e);if(r)try{return JSON.parse(r)}catch(n){return r}return null}};d($e,"singletons",{localStorage:null,sessionStorage:null});let q=$e;const M=new q("localStorage",x);function ke(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const I=(()=>{let t;(r=>{r.String="String",r.Number="Number",r.Boolean="Boolean",r.Date="Date",r.Array="Array",r.RegExp="RegExp",r.Symbol="Symbol",r.Function="Function",r.Object="Object"})(t||(t={}));function e(r,n){return Object.prototype.toString.call(r)===`[object ${n}]`}return{String:r=>e(r,"String"),Number:r=>e(r,"Number"),Boolean:r=>e(r,"Boolean"),Date:r=>e(r,"Date"),Array:r=>e(r,"Array"),RegExp:r=>e(r,"RegExp"),Symbol:r=>e(r,"Symbol"),Function:r=>e(r,"Function"),Object:r=>e(r,"Object")}})();function wt(){}function Ar(t){return new Promise(e=>setTimeout(e,t))}function Dr(t,e=400){let r=null;return function(...o){r&&(clearTimeout(r),r=null),r=window.setTimeout(()=>{t.call(this,...o)},e)}}function Pr(t,e=400){let r=null;return function(...o){r||(r=window.setTimeout(()=>{t.call(this,...o),r=null},e))}}function re(t){return Number.isNaN(Number(t))||Number.isNaN(Number.parseFloat(t))?t:Number(t)}function Hr(t){return t==="true"?!0:t==="false"?!1:t}function Q(t){return Array.isArray(t)?t:[t]}function Nr(t,e=0){ke(window,"requestIdleCallback")?window.requestIdleCallback(t):setTimeout(t,e)}function yt(t,e){const r={};return e.forEach(n=>{n in t&&(r[n]=t[n])}),r}function Br(t,e){let r={};return Object.entries(t).forEach(([n])=>{e(t[n],n)||(r[n]=t[n])}),r}function Et(t,e){var r;switch(e){case"IMG":case"AUDIO":case"VIDEO":return t.getAttribute("src");default:return(r=t.innerText)!=null?r:null}}function F(t,e){return r=>t.getConfigByTriggerType(r,e?"local":"remote")}function Ae(){var t;return(t=window.__localtimekey__)!=null?t:Math.floor(window.performance.timeOrigin)}function de(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?"pagehide":"beforeunload"}let vt=String.prototype.replaceAll;function Fr(){vt||(String.prototype.replaceAll=function(t,e){return Object.prototype.toString.call(t).toLowerCase()==="[object regexp]"?this.replace(t,e):this.replace(new RegExp(t,"g"),e)})}function jr(){String.prototype.replaceAll=vt}async function De(){const t=e=>Number.parseInt(String(e));return new Promise(e=>{var r;if(I.Function((r=window.performance)==null?void 0:r.now)){e(t(window.performance.now()));return}requestAnimationFrame(n=>{e(t(n))})})}const Pe={},w=new Proxy(console,{get(t,e){const r=L.getInstance().get("debug"),n=I.Function(Reflect.get(t,e));return!r&&n?wt:e==="verbose"?Ur:(Pe[e]||(Pe[e]=console[e].bind(console,"[MtTrack]")),Pe[e])}}),Ur=new Proxy(w,{get(t,e){return q.getInstance().get("__MT_TRACK_VERBOSE_LOGGER__")?w[e]:wt}}),St=()=>({serviceUrl:null,configServiceUrl:null,projectId:0,originalProjectId:0,weakProjectId:0,reportMode:"auto",debug:!1,performanceTrack:!0,localConfig:[],resourceTiming:{enabled:!1,hostWhitelist:[],typeWhitelist:["script","css"],sampleRate:.1},autoReportNetwork:!1}),se=class se{constructor(e){d(this,"data");this.data=e}static getInstance(){return this.singleton||(this.singleton=new se(St())),this.singleton}init(e){e&&(this.data=v(St(),e),this.data.originalProjectId=this.data.projectId,this.data.projectId=this.data.projectId||this.data.weakProjectId,w.info("Inited with options:",this.data))}set(e,r){this.data[e]=r}get(e){return this.data[e]}};d(se,"contextOptions",(()=>(Array.isArray(window==null?void 0:window[mt])?window[mt]:[]).reduce((r,n)=>{const[o,i]=n!=null?n:[];return r[o]=i,r},{}))()),d(se,"singleton",null);let He=se;const L=He;function qr(t){var e=[];for(var r in t)e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")}function Qr(t){t=t||{},t.type=(t.type||"GET").toUpperCase(),t.dataType=t.dataType||"json",t.async=t.async||!0;var e=qr(t.data),r=new XMLHttpRequest,n=()=>{t.headers&&I.Object(t.headers)&&Object.entries(t.headers).forEach(([o,i])=>{r.setRequestHeader(o,i)})};r.onreadystatechange=function(){if(r.readyState==4)try{var o=r.status,i=r.responseText!==""?r.responseText:"null";o>=200&&o<300?t.success&&t.success(t.dataType==="json"?JSON.parse(i):i,r.responseXML):t.fail&&t.fail(o)}catch(s){t.fail&&t.fail(s)}},t.type=="GET"?(r.open("GET",t.url+(e?`?${e}`:""),t.async),n(),r.send(null)):t.type=="POST"&&(r.open("POST",t.url,t.async),n(),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(e))}function Ne(t){return new Promise((e,r)=>{Qr(S(g({},t),{success:e,fail:r}))})}const Vr="https://api.gms.moontontech.com",Wr="https://sg-api.mobilelegends.com",Be={GET_CONFIG:`${Vr}/api/track/config`,REPORT:`${Wr}/r`},Tt=L.getInstance();function Fe(){const t=Tt.get("serviceUrl"),e=Be.REPORT;return t||e}function Gr(){const t=Tt.get("configServiceUrl"),e=Be.GET_CONFIG;return t||e}const je=t=>t.replace(/^\?/,"");function Ue(t){const e=je(t),r={};return e.length&&e.split("&").forEach(n=>{let[o,i]=n.split("=");try{o=decodeURIComponent(o),i=decodeURIComponent(i)}catch(s){return}r[o]=re(Hr(i))}),r}const{VITE_MT_ENV:bt}={VITE_MT_ENV:"prod",VITE_SERVER_GMS_HOST:"https://api.gms.moontontech.com",VITE_SERVER_ML_API_HOST:"https://sg-api.mobilelegends.com",VITE_PUBLIC_HOST:"https://static.mobilelegends.com",VITE_LIB_URL:"https://cdn.web.moontontech.com/lib/mtstatic",VITE_USER_NODE_ENV:"production",BASE_URL:"/",MODE:"prod",DEV:!1,PROD:!0,SSR:!1},Ot=Ue(location.search),qe=L.getInstance();async function Kr(t){const e=new URL(Gr()),r=!!(Ot.debug!=!1&&(bt==="indev"||bt==="dev"||Ot.debug||qe.get("debug")));r&&e.searchParams.set("debug",String(r));const{data:n}=await Ne({url:e.href,headers:{"x-appid":String(t.projectId)}}),{debug:o,config:i,attributeCdnPrefix:s,eventCdnPrefix:a,trackCdnPrefix:c}=n.client;let u,f,h,p;o&&(u=s,f=a,h=c),o||([h,u,f]=await Promise.all([c,s,a].map(T=>Ne({url:`${T}.json`}))));const m=h.tracks||[],C=[...u,...f];return p=m.reduce((T,b)=>{const G=yt(b,["id","caption"]);return G.data=yt(b.data,["active","desc","extra","filter","name"]),G.data.trigger=(()=>{const N=C.find(B=>B.id===b.data.trigger);return N?{id:N.id,name:N.data.name,data:N.data.data}:T})(),G.data.filter=(G.data.filter||[]).reduce((N,B)=>{var Rr;if(((Rr=B.type)==null?void 0:Rr.type)==="property"){const $r=C.find(vi=>vi.id===B.type.data);if(!$r)return w.warn("Invalid filter found.",B),N;B.type.data=$r.data.name}return N.push(B),N},[]),T.push(G),T},[]),{trackConfigs:p,appConfig:i}}function zr(t){const e=qe.get("projectId");return Ne({url:Fe(),type:"POST",data:{v6:JSON.stringify(t),project:String(e!=null?e:"")}})}function It(t,e){var i;const r=new URLSearchParams,n=qe.get("projectId");r.set("v6",JSON.stringify(t)),r.set("project",(i=String(n))!=null?i:"");const o=new Blob([r.toString()],{type:"application/x-www-form-urlencoded"});return navigator.sendBeacon(e||Fe(),o)}function Xr(t){const e=new Map;return t.forEach(r=>{const n=e.get(r.trigger.type);e.set(r.trigger.type,n?n.concat(r):[r])}),e}var _=(t=>(t.PAGE_ENTER="web.page_enter",t.PAGE_LEAVE="web.page_leave",t.CLICK="web.element_click",t.SCROLL="web.element_scroll",t.NETWORK="web.request",t.SCAN="web.element_scan",t.EXCEPTION="internal.exception",t.MANUAL="web.manual",t))(_||{});const Qe=["element_index"],Ve={"web.element_click":[...Qe],"web.element_scroll":[...Qe],"web.element_scan":[...Qe]};var R=(t=>(t.CONSTANT="constant",t.ELEMENT="element",t.STORAGE="storage",t.SESSION="session",t.COOKIE="cookie",t))(R||{});function Yr(t){const e=[];return t.forEach(({data:r})=>{var f;const{active:n=!1,trigger:o,name:i,filter:s=[],extra:a=[]}=r,{name:c}=o;if(!n)return;const u={};c&&i&&(u.name=i,u.mode="remote",o.data=o.data||[],u.trigger={id:o.id,type:c,_reportParameterSet:new Set(o.data.filter(h=>h.if_report).map(h=>h.name)),_postCheckParameters:(f=Ve[c])!=null?f:[]},u.filters=s.map(h=>{var p;return{type:h.compare,target:h.value,source:{type:h.type.type,key:I.String(h.type.data)?h.type.data:(p=h.type.data)==null?void 0:p.name}}}),u.extra=a.map(h=>{const p={key:h.name,type:h.access.type};if(p.type===R.ELEMENT){const{range:m,selector:C=null,attribute:T}=h.access.data;p.data={range:m,selector:C,attribute:T.type==="customize_attribute"?T.data:T.type}}else p.data=h.access.data;return p}),e.push(u))}),e}function Jr(t){const e=[],r=new Set(Object.values(_));return t.forEach(n=>{var c;const{trigger:o,name:i,filters:s,extra:a}=n;try{if(!r.has(o.type))return;const u=o.type,f={};f.name=i,f.mode="local",f.trigger={type:u,_reportParameterSet:new Set(o.reportParameters),_postCheckParameters:(c=Ve[u])!=null?c:[]},f.filters=s!=null?s:[],f.extra=a!=null?a:[],e.push(f)}catch(u){w.warn("Failed to resolve local config:",n)}}),e}const Zr=30*60*1e3;class en{constructor({refreshInterval:e=Zr}={}){d(this,"refreshInterval");d(this,"data",[]);d(this,"localData",[]);d(this,"groupedData",new Map);d(this,"timer");d(this,"ready",!1);d(this,"event",E());this.refreshInterval=e}init(e){this.fetch(),this.setupRefreshTimer(),this.addLocalConfig(e!=null?e:[])}addLocalConfig(e){const r=Q(e),n=Jr(r);this.localData.push(...n),this.updateGroupedData(),w.log("Local config of added:",n)}isReady(){return this.ready}getConfigByTriggerType(e,r){const n=this.groupedData.get(e);return n?r==="all"?n:n.filter(o=>o.mode===r):null}updateGroupedData(){this.groupedData=Xr([...this.data,...this.localData])}async fetch(){var n;const e=L.getInstance(),r=await e.get("originalProjectId");try{let o=[],i={};if(r){const a=await Kr({projectId:r});o=a.trackConfigs,i=a.appConfig}const s=!!this.data;e.get("serviceUrl")||e.set("serviceUrl",(n=i&&i.api_url)!=null?n:null),this.data=Yr(o),this.updateGroupedData(),this.ready=!0,r?w.log(`Remote config of project '${r}' fetched:`,this.data):w.log("No project id found. Remote config not fetched."),this.event.emit(s?"ready":"refreshed",this.data)}catch(o){o instanceof Error&&w.error("Failed to fetch track config. Error message:",o)}}setupRefreshTimer(e=this.refreshInterval){this.cancelRefreshTimer(),this.timer=window.setTimeout(()=>(this.fetch(),this.setupRefreshTimer()),e)}cancelRefreshTimer(){window.clearInterval(this.timer)}}class We{static internalAdd(e){let r;ke(window,"requestIdleCallback")?r=window.requestIdleCallback(()=>{this.queue.delete(r),e()}):r=window.setTimeout(()=>{this.queue.delete(r),e()}),this.queue.set(r,{fn:e,id:r})}static internalCancel(e){ke(window,"requestIdleCallback")?window.cancelIdleCallback(e):window.clearTimeout(e)}static add(e){this.internalAdd(e)}static async flush(){for(const[e,r]of this.queue)this.internalCancel(e),await r.fn();this.queue.clear()}}d(We,"queue",new Map);const xt={flushThreshold:3,flushTimeout:3*1e3};class tn{constructor(e=xt){d(this,"options");d(this,"data",[]);d(this,"asyncTasks",new Set);d(this,"timer");d(this,"event",E());const r=g(g({},xt),e);this.options=r,this.options.flushTimeout=this.formatFlushTimeout(this.options.flushTimeout),this.unloadFlushListener=this.unloadFlushListener.bind(this),this.setupUnloadFlushListener()}async unloadFlushListener(){await We.flush(),(this.data.length||this.asyncTasks.size)&&this.flush(!0)}setupUnloadFlushListener(){window.addEventListener(de(),this.unloadFlushListener)}reSetupUnloadFlushListener(){window.removeEventListener(de(),this.unloadFlushListener),this.setupUnloadFlushListener()}formatFlushTimeout(e){return e<0?-1:Math.max(1*1e3,Math.min(10*1e3,e))}setFlushThreshold(e){this.options.flushThreshold=e}push(e){const r=Q(e);this.data.push(...r),q.getInstance().get("__MT_TRACK_VERBOSE_LOGGER__")&&w.log("New items pushed into report queue:",r),this.data.length>=this.options.flushThreshold?this.flush():this.setupTimeoutFlushTimer()}pushAsync(e){let r=!1;const n=e.getFallback,o=s=>(r=!0,this.asyncTasks.delete(e),n(s));e.getFallback=o,this.asyncTasks.add(e);const i=()=>{var a;if(r)return;const s=(a=e.getFallback)==null?void 0:a.call(e,"rejection");s&&this.push(s)};e.promise.then(s=>this.push(s)).catch(i).finally(()=>this.asyncTasks.delete(e)),q.getInstance().get("__MT_TRACK_VERBOSE_LOGGER__")&&w.log("New async task registered:",e)}flush(e=!1){const r=this.data.splice(0,Number.POSITIVE_INFINITY);e&&(this.asyncTasks.forEach(n=>{const o=n.getFallback("unload");o&&r.push(o)}),this.asyncTasks.clear()),r.length&&this.event.emit("flush",{data:r,lastBeat:e})}recoverQueueFromStorage(){const e=M.get(ue,[]);e.length&&(this.push(e),M.set(ue,[]))}storeQueueToStorage(e){let r=M.get(ue,[]);r=r.concat(e!=null?e:this.data),M.set(ue,r)}setupTimeoutFlushTimer(){const{flushTimeout:e}=this.options;this.cancelTimeoutFlushTimer(),!(e<0)&&(this.timer=window.setTimeout(()=>{this.flush()},this.options.flushTimeout))}cancelTimeoutFlushTimer(){window.clearTimeout(this.timer)}}class rn{constructor({taskQueue:e}){d(this,"taskQueue");this.handleTaskQueueFlush=this.handleTaskQueueFlush.bind(this),this.taskQueue=e,this.watchTaskQueue()}watchTaskQueue(){this.taskQueue.event.on("flush",this.handleTaskQueueFlush)}async sendByAjax(e){try{await zr(e)}catch(r){w.error("Failed to send report data:",e,"error: ",r)}}sendByBeacon(e){return I.Function(navigator.sendBeacon)?It(e):!1}send(e){return w.log("Send data",e),this.sendByBeacon(e)}handleTaskQueueFlush(e){const{data:r,lastBeat:n}=e;this.send(r)||(n?this.taskQueue.storeQueueToStorage(r):this.sendByAjax(r))}}var y=(t=>(t.HASH_CHANGE="hashChange",t.HISTORY_CHANGE="historyChange",t.CLICK="click",t.SCROLL="scroll",t.NETWORK="network",t.UNLOAD="unload",t.VISIBILITY_CHANGE="visibilityChange",t.SCAN="scan",t.EXCEPTION="exception",t.RESOURCE_TIMING="resourceTiming",t.PAGE_VISIT="pageVisit",t))(y||{});let fe;const nn=new Uint8Array(16);function on(){if(!fe&&(fe=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!fe))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return fe(nn)}const O=[];for(let t=0;t<256;++t)O.push((t+256).toString(16).slice(1));function sn(t,e=0){return O[t[e+0]]+O[t[e+1]]+O[t[e+2]]+O[t[e+3]]+"-"+O[t[e+4]]+O[t[e+5]]+"-"+O[t[e+6]]+O[t[e+7]]+"-"+O[t[e+8]]+O[t[e+9]]+"-"+O[t[e+10]]+O[t[e+11]]+O[t[e+12]]+O[t[e+13]]+O[t[e+14]]+O[t[e+15]]}const _t={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Ge(t,e,r){if(_t.randomUUID&&!e&&!t)return _t.randomUUID();t=t||{};const n=t.random||(t.rng||on)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let o=0;o<16;++o)e[r+o]=n[o];return e}return sn(n)}function an(t){return new Promise((e,r)=>{var s;const n=document.createElement("script"),o=()=>{e(),n.removeEventListener("load",o)},i=a=>{r(a),n.removeEventListener("error",i)};n.addEventListener("load",o),n.addEventListener("error",i),n.src=t,(s=document.querySelector("head"))==null||s.appendChild(n)})}const cn="https://cdn.web.moontontech.com/lib/mtstatic/js/fingerprint_v3.3.4.min.js";let Ke=M.get(le);const K=async()=>{if(!Ke){await an(cn);const t=await FingerprintJS.load(),{visitorId:e}=await t.get();Ke=e,M.set(le,e)}return Ke},pe=()=>{let t=M.get(ht);if(!t)try{t=Ge(),M.set(ht,t)}catch(e){t="",console.error("Failed to generate uuid, error:",e)}return t},un=30*60*1e3;function he(){const t=Date.now();try{const n=M.get(gt);if(n&&typeof n=="string"){const o=JSON.parse(n);if(o.sessionId&&o.timestamp&&t-o.timestamp<=un)return o.sessionId}}catch(n){console.warn("Failed to parse session data from localStorage:",n)}const e=Ge(),r={sessionId:e,timestamp:t};try{M.set(gt,JSON.stringify(r))}catch(n){console.warn("Failed to save session data to localStorage:",n)}return e}let ze=null;const ge=()=>(ze||(ze=Ge()),ze);class k{static set(e,r){this.extra[e]=r}static get(e){return this.extra[e]}static getAll(){return g({},this.extra)}static remove(e){delete this.extra[e]}static clear(){this.extra={}}}d(k,"extra",{});var me=window,V=window.navigator,z=function(t,e){var r=V.mimeTypes;for(var n in r)if(r[n][t]==e)return!0;return!1};function ln(t){var e=t||V.userAgent||{},r={},n={Trident:e.indexOf("Trident")>-1||e.indexOf("NET CLR")>-1,Presto:e.indexOf("Presto")>-1,WebKit:e.indexOf("AppleWebKit")>-1,Gecko:e.indexOf("Gecko/")>-1,KHTML:e.indexOf("KHTML/")>-1,Safari:e.indexOf("Safari")>-1,Chrome:e.indexOf("Chrome")>-1||e.indexOf("CriOS")>-1,IE:e.indexOf("MSIE")>-1||e.indexOf("Trident")>-1,Edge:e.indexOf("Edge")>-1||e.indexOf("Edg/")>-1||e.indexOf("EdgA")>-1||e.indexOf("EdgiOS")>-1,Firefox:e.indexOf("Firefox")>-1||e.indexOf("FxiOS")>-1,"Firefox Focus":e.indexOf("Focus")>-1,Chromium:e.indexOf("Chromium")>-1,Opera:e.indexOf("Opera")>-1||e.indexOf("OPR")>-1,Vivaldi:e.indexOf("Vivaldi")>-1,Yandex:e.indexOf("YaBrowser")>-1,Arora:e.indexOf("Arora")>-1,Lunascape:e.indexOf("Lunascape")>-1,QupZilla:e.indexOf("QupZilla")>-1,"Coc Coc":e.indexOf("coc_coc_browser")>-1,Kindle:e.indexOf("Kindle")>-1||e.indexOf("Silk/")>-1,Iceweasel:e.indexOf("Iceweasel")>-1,Konqueror:e.indexOf("Konqueror")>-1,Iceape:e.indexOf("Iceape")>-1,SeaMonkey:e.indexOf("SeaMonkey")>-1,Epiphany:e.indexOf("Epiphany")>-1,360:e.indexOf("QihooBrowser")>-1||e.indexOf("QHBrowser")>-1,"360EE":e.indexOf("360EE")>-1,"360SE":e.indexOf("360SE")>-1,UC:e.indexOf("UCBrowser")>-1||e.indexOf(" UBrowser")>-1||e.indexOf("UCWEB")>-1,QQBrowser:e.indexOf("QQBrowser")>-1,QQ:e.indexOf("QQ/")>-1,Baidu:e.indexOf("Baidu")>-1||e.indexOf("BIDUBrowser")>-1||e.indexOf("baidubrowser")>-1||e.indexOf("baiduboxapp")>-1||e.indexOf("BaiduHD")>-1,Maxthon:e.indexOf("Maxthon")>-1,Sogou:e.indexOf("MetaSr")>-1||e.indexOf("Sogou")>-1,Liebao:e.indexOf("LBBROWSER")>-1||e.indexOf("LieBaoFast")>-1,"2345Explorer":e.indexOf("2345Explorer")>-1||e.indexOf("Mb2345Browser")>-1||e.indexOf("2345chrome")>-1,"115Browser":e.indexOf("115Browser")>-1,TheWorld:e.indexOf("TheWorld")>-1,XiaoMi:e.indexOf("MiuiBrowser")>-1,Quark:e.indexOf("Quark")>-1,Qiyu:e.indexOf("Qiyu")>-1,Wechat:e.indexOf("MicroMessenger")>-1,WechatWork:e.indexOf("wxwork/")>-1,Taobao:e.indexOf("AliApp(TB")>-1,Alipay:e.indexOf("AliApp(AP")>-1,Weibo:e.indexOf("Weibo")>-1,Douban:e.indexOf("com.douban.frodo")>-1,Suning:e.indexOf("SNEBUY-APP")>-1,iQiYi:e.indexOf("IqiyiApp")>-1,DingTalk:e.indexOf("DingTalk")>-1,Huawei:e.indexOf("HuaweiBrowser")>-1||e.indexOf("HUAWEI/")>-1||e.indexOf("HONOR")>-1||e.indexOf("HBPC/")>-1,Vivo:e.indexOf("VivoBrowser")>-1,Windows:e.indexOf("Windows")>-1,Linux:e.indexOf("Linux")>-1||e.indexOf("X11")>-1,"Mac OS":e.indexOf("Macintosh")>-1,Android:e.indexOf("Android")>-1||e.indexOf("Adr")>-1,HarmonyOS:e.indexOf("HarmonyOS")>-1,Ubuntu:e.indexOf("Ubuntu")>-1,FreeBSD:e.indexOf("FreeBSD")>-1,Debian:e.indexOf("Debian")>-1,"Windows Phone":e.indexOf("IEMobile")>-1||e.indexOf("Windows Phone")>-1,BlackBerry:e.indexOf("BlackBerry")>-1||e.indexOf("RIM")>-1,MeeGo:e.indexOf("MeeGo")>-1,Symbian:e.indexOf("Symbian")>-1,iOS:e.indexOf("like Mac OS X")>-1,"Chrome OS":e.indexOf("CrOS")>-1,WebOS:e.indexOf("hpwOS")>-1,Mobile:e.indexOf("Mobi")>-1||e.indexOf("iPh")>-1||e.indexOf("480")>-1,Tablet:e.indexOf("Tablet")>-1||e.indexOf("Pad")>-1||e.indexOf("Nexus 7")>-1||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,isWebview:e.indexOf("; wv)")>-1},o=!1;if(me.chrome){var i=e.replace(/^.*Chrome\/([\d]+).*$/,"$1");me.chrome.adblock2345||me.chrome.common2345?n["2345Explorer"]=!0:z("type","application/360softmgrplugin")||z("type","application/mozilla-npqihooquicklogin")||i>36&&me.showModalDialog?o=!0:i>45&&(o=z("type","application/vnd.chromium.remoting-viewer"),!o&&i>=69&&(o=z("type","application/hwepass2001.installepass2001")||z("type","application/asx")))}n.Mobile?n.Mobile=!(e.indexOf("iPad")>-1):o&&(z("type","application/gameplugin")||V&&typeof V.connection<"u"&&typeof V.connection.saveData>"u"?n["360SE"]=!0:n["360EE"]=!0),n.Baidu&&n.Opera?n.Baidu=!1:n.iOS&&(n.Safari=!0);var s={engine:["WebKit","Trident","Gecko","Presto","KHTML"],browser:["Safari","Chrome","Edge","IE","Firefox","Firefox Focus","Chromium","Opera","Vivaldi","Yandex","Arora","Lunascape","QupZilla","Coc Coc","Kindle","Iceweasel","Konqueror","Iceape","SeaMonkey","Epiphany","XiaoMi","Vivo","360","360SE","360EE","UC","QQBrowser","QQ","Huawei","Baidu","Maxthon","Sogou","Liebao","2345Explorer","115Browser","TheWorld","Quark","Qiyu","Wechat","WechatWork","Taobao","Alipay","Weibo","Douban","Suning","iQiYi","DingTalk"],os:["Windows","Linux","Mac OS","Android","HarmonyOS","Ubuntu","FreeBSD","Debian","iOS","Windows Phone","BlackBerry","MeeGo","Symbian","Chrome OS","WebOS"],device:["Mobile","Tablet"]};r.device="PC",r.language=function(){var p=V.browserLanguage||V.language,m=p.split("-");return m[1]&&(m[1]=m[1].toUpperCase()),m.join("_")}();for(var a in s)for(var c=0;c<s[a].length;c++){var u=s[a][c];n[u]&&(r[a]=u)}var f={Windows:function(){var p=e.replace(/^Mozilla\/\d.0 \(Windows NT ([\d.]+)[;)].*$/,"$1"),m={10:"10","6.4":"10","6.3":"8.1","6.2":"8","6.1":"7","6.0":"Vista","5.2":"XP","5.1":"XP","5.0":"2000"};return m[p]||p},Android:function(){return e.replace(/^.*Android ([\d.]+);.*$/,"$1")},HarmonyOS:function(){var p=e.replace(/^Mozilla.*Android ([\d.]+)[;)].*$/,"$1"),m={10:"2"};return m[p]||""},iOS:function(){return e.replace(/^.*OS ([\d_]+) like.*$/,"$1").replace(/_/g,".")},Debian:function(){return e.replace(/^.*Debian\/([\d.]+).*$/,"$1")},"Windows Phone":function(){return e.replace(/^.*Windows Phone( OS)? ([\d.]+);.*$/,"$2")},"Mac OS":function(){return e.replace(/^.*Mac OS X ([\d_]+).*$/,"$1").replace(/_/g,".")},WebOS:function(){return e.replace(/^.*hpwOS\/([\d.]+);.*$/,"$1")}};r.osVersion="",f[r.os]&&(r.osVersion=f[r.os](),r.osVersion==e&&(r.osVersion="")),r.isWebview=n.isWebview;var h={Safari:function(){return e.replace(/^.*Version\/([\d.]+).*$/,"$1")},Chrome:function(){return e.replace(/^.*Chrome\/([\d.]+).*$/,"$1").replace(/^.*CriOS\/([\d.]+).*$/,"$1")},IE:function(){return e.replace(/^.*MSIE ([\d.]+).*$/,"$1").replace(/^.*rv:([\d.]+).*$/,"$1")},Edge:function(){return e.replace(/^.*Edge\/([\d.]+).*$/,"$1").replace(/^.*Edg\/([\d.]+).*$/,"$1").replace(/^.*EdgA\/([\d.]+).*$/,"$1").replace(/^.*EdgiOS\/([\d.]+).*$/,"$1")},Firefox:function(){return e.replace(/^.*Firefox\/([\d.]+).*$/,"$1").replace(/^.*FxiOS\/([\d.]+).*$/,"$1")},"Firefox Focus":function(){return e.replace(/^.*Focus\/([\d.]+).*$/,"$1")},Chromium:function(){return e.replace(/^.*Chromium\/([\d.]+).*$/,"$1")},Opera:function(){return e.replace(/^.*Opera\/([\d.]+).*$/,"$1").replace(/^.*OPR\/([\d.]+).*$/,"$1")},Vivaldi:function(){return e.replace(/^.*Vivaldi\/([\d.]+).*$/,"$1")},Yandex:function(){return e.replace(/^.*YaBrowser\/([\d.]+).*$/,"$1")},Arora:function(){return e.replace(/^.*Arora\/([\d.]+).*$/,"$1")},Lunascape:function(){return e.replace(/^.*Lunascape[\/\s]([\d.]+).*$/,"$1")},QupZilla:function(){return e.replace(/^.*QupZilla[\/\s]([\d.]+).*$/,"$1")},"Coc Coc":function(){return e.replace(/^.*coc_coc_browser\/([\d.]+).*$/,"$1")},Kindle:function(){return e.replace(/^.*Version\/([\d.]+).*$/,"$1")},Iceweasel:function(){return e.replace(/^.*Iceweasel\/([\d.]+).*$/,"$1")},Konqueror:function(){return e.replace(/^.*Konqueror\/([\d.]+).*$/,"$1")},Iceape:function(){return e.replace(/^.*Iceape\/([\d.]+).*$/,"$1")},SeaMonkey:function(){return e.replace(/^.*SeaMonkey\/([\d.]+).*$/,"$1")},Epiphany:function(){return e.replace(/^.*Epiphany\/([\d.]+).*$/,"$1")},360:function(){return e.replace(/^.*QihooBrowser\/([\d.]+).*$/,"$1")},"360SE":function(){var p={86:"13.0",78:"12.0",69:"11.0",63:"10.0",55:"9.1",45:"8.1",42:"8.0",31:"7.0",21:"6.3"},m=e.replace(/^.*Chrome\/([\d]+).*$/,"$1");return p[m]||""},"360EE":function(){var p={95:"21",86:"13.0",78:"12.0",69:"11.0",63:"9.5",55:"9.0",50:"8.7",30:"7.5"},m=e.replace(/^.*Chrome\/([\d]+).*$/,"$1");return p[m]||""},Maxthon:function(){return e.replace(/^.*Maxthon\/([\d.]+).*$/,"$1")},QQBrowser:function(){return e.replace(/^.*QQBrowser\/([\d.]+).*$/,"$1")},QQ:function(){return e.replace(/^.*QQ\/([\d.]+).*$/,"$1")},Baidu:function(){return e.replace(/^.*BIDUBrowser[\s\/]([\d.]+).*$/,"$1").replace(/^.*baiduboxapp\/([\d.]+).*$/,"$1")},UC:function(){return e.replace(/^.*UC?Browser\/([\d.]+).*$/,"$1")},Sogou:function(){return e.replace(/^.*SE ([\d.X]+).*$/,"$1").replace(/^.*SogouMobileBrowser\/([\d.]+).*$/,"$1")},Liebao:function(){var p="";e.indexOf("LieBaoFast")>-1&&(p=e.replace(/^.*LieBaoFast\/([\d.]+).*$/,"$1"));var m={57:"6.5",49:"6.0",46:"5.9",42:"5.3",39:"5.2",34:"5.0",29:"4.5",21:"4.0"},C=e.replace(/^.*Chrome\/([\d]+).*$/,"$1");return p||m[C]||""},"2345Explorer":function(){var p={69:"10.0",55:"9.9"},m=navigator.userAgent.replace(/^.*Chrome\/([\d]+).*$/,"$1");return p[m]||e.replace(/^.*2345Explorer\/([\d.]+).*$/,"$1").replace(/^.*Mb2345Browser\/([\d.]+).*$/,"$1")},"115Browser":function(){return e.replace(/^.*115Browser\/([\d.]+).*$/,"$1")},TheWorld:function(){return e.replace(/^.*TheWorld ([\d.]+).*$/,"$1")},XiaoMi:function(){return e.replace(/^.*MiuiBrowser\/([\d.]+).*$/,"$1")},Vivo:function(){return e.replace(/^.*VivoBrowser\/([\d.]+).*$/,"$1")},Quark:function(){return e.replace(/^.*Quark\/([\d.]+).*$/,"$1")},Qiyu:function(){return e.replace(/^.*Qiyu\/([\d.]+).*$/,"$1")},Wechat:function(){return e.replace(/^.*MicroMessenger\/([\d.]+).*$/,"$1")},WechatWork:function(){return e.replace(/^.*wxwork\/([\d.]+).*$/,"$1")},Taobao:function(){return e.replace(/^.*AliApp\(TB\/([\d.]+).*$/,"$1")},Alipay:function(){return e.replace(/^.*AliApp\(AP\/([\d.]+).*$/,"$1")},Weibo:function(){return e.replace(/^.*weibo__([\d.]+).*$/,"$1")},Douban:function(){return e.replace(/^.*com.douban.frodo\/([\d.]+).*$/,"$1")},Suning:function(){return e.replace(/^.*SNEBUY-APP([\d.]+).*$/,"$1")},iQiYi:function(){return e.replace(/^.*IqiyiVersion\/([\d.]+).*$/,"$1")},DingTalk:function(){return e.replace(/^.*DingTalk\/([\d.]+).*$/,"$1")},Huawei:function(){return e.replace(/^.*Version\/([\d.]+).*$/,"$1").replace(/^.*HuaweiBrowser\/([\d.]+).*$/,"$1").replace(/^.*HBPC\/([\d.]+).*$/,"$1")}};return r.version="",h[r.browser]&&(r.version=h[r.browser](),r.version==e&&(r.version="")),r.browser=="Chrome"&&e.match(/\S+Browser/)&&(r.browser=e.match(/\S+Browser/)[0],r.version=e.replace(/^.*Browser\/([\d.]+).*$/,"$1")),r.browser=="Edge"?r.engine=parseInt(r.version)>75?"Blink":"EdgeHTML":(n.Chrome&&r.engine=="WebKit"&&parseInt(h.Chrome())>27||r.browser=="Opera"&&parseInt(r.version)>12||r.browser=="Yandex")&&(r.engine="Blink"),r}let Xe=null;function ne(){const t={};if(t.screen_width=window.screen.width,t.screen_height=window.screen.height,t.url_host=window.location.host,t.url=window.location.href,t.ua=window.navigator.userAgent,!Xe){const e=ln(t.ua);Xe={phone_brand:dn(t.ua),browser_brand:e.browser,browser_engine:e.engine,browser_version:e.version,os_platform:e.os,os_version:e.osVersion,sdk_version:"0.13.5",visit_id:Ae()}}return Object.assign(t,Xe),t}function dn(t){const e=Object.entries({iphone:"iphone",hauwei:["huawei","honor"],oppo:["oppo","pacm00"],vivo:"vivo",xiaomi:["mi ","mix ","redmi"],samsung:"sm-",pixel:"pixel"});let r="other";for(let n=0;n<e.length;n++){const[o,i]=e[n];if((typeof i=="string"?[i]:i).some(c=>{var u;return((u=t.match(new RegExp(c,"i")))==null?void 0:u.toString().toLowerCase())===c})){r=o;break}}return r}const fn={name:R.CONSTANT,get(t){return t.toString()}},pn=["innerHTML","outerHTML","innerText"],hn={name:R.ELEMENT,get(t,e){var s,a,c;const{range:r,selector:n,attribute:o=""}=t;let i;if(n?i=((s=r==="global"?document:e.triggerData._target)!=null?s:document).querySelector(n):i=e.triggerData._target,!i)return null;switch(!0){case o==="":return Et(i,i.tagName);case pn.includes(o):return(c=(a=i[o])==null?void 0:a.toString())!=null?c:null;default:return i.getAttribute(o)}}},gn={localStorage:R.STORAGE,sessionStorage:R.SESSION};function Ct(t){return{name:gn[t],get(e){var a;const r=q.getInstance(t),[n,...o]=e.toString().split("."),i=(a=r.get(n))!=null?a:null;let s;if(i==null)return w.warn(`Data in ${t} with key '${n}' not found.`),null;try{s=o.reduce((c,u)=>{if(c[u]===void 0)throw new Error("Unexpected access");return c[u]},i)}catch(c){return w.error(`Failed to get '${o.join(".")}' in ${t} data '${n}':`,i),null}return s}}}const mn=Ct("localStorage");function wn(t){const r=document.cookie.split(";").map(n=>n.trim());for(let n=0;n<r.length;n++){const[o,i]=r[n].split("=");if(decodeURIComponent(o)===t)return decodeURIComponent(i)}return null}const yn={name:R.COOKIE,get(t){const e=wn(t.toString());return e===null&&w.warn(`Data in Cookie with key '${t}' not found.`),e}};class Lt{static get(e,r){let n={};return e.length&&e.forEach(o=>{const i=this.getters[o.type];if(!i||!I.Function(i.get)){w.warn(`Can not find appropriate getter for output type: ${o.type}`);return}n[o.key]=i.get(o.data,r)}),n}}d(Lt,"getters",{[R.CONSTANT]:fn,[R.ELEMENT]:hn,[R.STORAGE]:mn,[R.SESSION]:Ct("sessionStorage"),[R.COOKIE]:yn});async function Mt(t,e,r){const n=ne(),[o,i,s,a]=await Promise.all([K(),r.projectId,De(),k.getAll()]);return{did:o,uuid:pe(),session_id:he(),page_view_id:ge(),type:"event",meta_event:t.trigger.type,project:i,properties:{event_name:t.name,time:r.ts||Date.now(),timeOffset:s,property:n,parameter:e,extra:a}}}async function j(t,e,r){const n=ne(),o=Lt.get(t.extra,{properties:n,triggerData:e}),i=En(e,t.trigger._reportParameterSet),[s,a,c,u]=await Promise.all([K(),r.projectId,De(),k.getAll()]);return{did:s,uuid:pe(),session_id:he(),page_view_id:ge(),type:"event",meta_event:t.trigger.type,project:a,properties:{event_name:t.name,time:r.ts||Date.now(),timeOffset:c,property:n,parameter:i,extra:g(g({},o),u)}}}async function Rt(t,e){const r=ne(),[n,o,i,s]=await Promise.all([K(),e.projectId,De(),k.getAll()]),a=t.errorType||"js";return{did:n,uuid:pe(),session_id:he(),page_view_id:ge(),type:"error",url:location.href,params:location.search.replace(/^\?/,""),project:o,time:e.ts||Date.now(),timeOffset:i,property:r,error:g({message:t.message,stack:t.stack,location:t.location,errorType:a},t.resourceType&&{resourceType:t.resourceType}),extra:s}}function En(t,e){let r=g({},t);"parameters"in t&&"_oParameters"in t&&(r.parameters=g({},r._oParameters)),r=Br(r,(o,i)=>i.toString().startsWith("_")||!e.has(i.toString()));const n=o=>{Object.entries(o).forEach(([i,s])=>{I.Object(s)?n(s):String(s).length>1024**2&&(o[i]="(too large)")})};return n(r),r}const vn=async t=>{const{data:e,ctx:r}=t,n=r.optionManager.get("projectId"),o=Sn(e),i=await Rt(o,{projectId:n,ts:Date.now()});r.reportQueue.push(i)};function Sn(t){const e=t.errorType==="resource";return g(g({message:t.message,stack:t.stack,location:e?t.resourceUrl:`${t.filename}:${t.lineno}:${t.colno}`},t.errorType&&{errorType:t.errorType}),t.resourceType&&{resourceType:t.resourceType})}function $t(t){try{return JSON.stringify(t)}catch(e){return String(t)}}function kt(t){const e="(no message)";return t==null?e:t instanceof Error?$t(t.message)||e:$t(t)}function Tn(t){const e=t&&(t instanceof HTMLImageElement||t instanceof HTMLScriptElement||t instanceof HTMLLinkElement||t instanceof HTMLVideoElement||t instanceof HTMLAudioElement||t instanceof HTMLSourceElement||t instanceof HTMLIFrameElement);let r="js",n,o;return e&&(r="resource",t instanceof HTMLImageElement||t instanceof HTMLVideoElement||t instanceof HTMLAudioElement||t instanceof HTMLSourceElement?(n=t.src,o=t instanceof HTMLImageElement?"img":t instanceof HTMLVideoElement?"video":t instanceof HTMLAudioElement?"audio":"source"):t instanceof HTMLScriptElement?(n=t.src,o="script"):t instanceof HTMLLinkElement?(n=t.href,o="link"):t instanceof HTMLIFrameElement?(n=t.src,o="iframe"):o="other"),{errorType:r,resourceUrl:n,resourceType:o}}const bn={name:y.EXCEPTION,setup(t){window.addEventListener("error",e=>{var a,c,u,f,h,p,m;const{errorType:r,resourceUrl:n,resourceType:o}=Tn(e.target),i=r==="resource",s=g({type:e.type,message:i?`Resource load failed: ${n||"(unknown resource)"}`:(a=kt(e.error||e.message))!=null?a:"(no message)",filename:i?n||((c=e.filename)!=null?c:"(unknown file)"):(u=e.filename)!=null?u:"(unknown file)",stack:i?"":(h=(f=e.error)==null?void 0:f.stack)!=null?h:"",lineno:i?0:(p=e.lineno)!=null?p:0,colno:i?0:(m=e.colno)!=null?m:0,errorType:r},i&&{resourceUrl:n,resourceType:o});t(y.EXCEPTION,s)},!0),window.addEventListener("unhandledrejection",e=>{const r={type:e.type,message:kt(e.reason),filename:"(unknown file)",stack:"",lineno:0,colno:0,errorType:"promise"};t(y.EXCEPTION,r)})},consume(t,e,r){r&&vn({data:e,ctx:t})}},On=async t=>{const{data:e,ctx:r,premature:n}=t;if(!e||!n)return;const o=r.optionManager.get("projectId"),i=Array.isArray(e)?e:[e];if(i.length===0)return;const c=await Mt({name:"__resource_timing__",mode:"remote",trigger:{type:"__performance_tracks__",_reportParameterSet:new Set,_postCheckParameters:[]},filters:[],extra:[]},{resources:i},{projectId:typeof o=="number"?o:0,ts:Date.now()});r.reportQueue.push(c)};function In(t,e){if(["script","img","xmlhttprequest","fetch","beacon","video","audio","iframe","frame","embed","object"].includes(e))return e;const n=xn(t);if(n){if(n==="css")return"css";if(["woff","woff2","ttf","otf","eot"].includes(n))return"font";if(["js","mjs","cjs"].includes(n))return"script";if(["jpg","jpeg","png","gif","svg","webp","ico","bmp"].includes(n))return"img";if(["mp4","webm","ogg","mov","avi"].includes(n))return"video";if(["mp3","wav","ogg","aac","m4a"].includes(n))return"audio"}return e}function xn(t){try{const n=new URL(t).pathname.match(/\.([^./]+)$/);return n?n[1].toLowerCase():""}catch(e){const r=t.match(/\.([^./]+)(\?|#|$)/);return r?r[1].toLowerCase():""}}function _n(t,e){if(!e||e.length===0)return!0;const r=Cn(t);return r?e.some(n=>Ln(r,n)):!1}function Cn(t){try{return new URL(t).hostname}catch(e){try{return window.location.hostname}catch(r){return null}}}function Ln(t,e){return!!(e==="*"||t===e||t.endsWith("."+e))}const l=class l{static start(e,r){l.stop(),l.notify=e,l.options=r,l.stopped=!1,!l.setupPerformanceObserver()&&l.setupFallbackCollector()}static stop(e=!0){l.stopped=!0,l.observer&&(l.observer.disconnect(),l.observer=null),l.cancelFlushTimer(),e&&l.queue.length>0&&(l.hasReportedInitial?l.flushQueue():(l.hasReportedInitial=!0,l.flushInitialQueue())),l.queue=[],l.processedResources.clear(),l.notify=null,l.options=null}static setupPerformanceObserver(){var e;if(typeof PerformanceObserver>"u"||!((e=PerformanceObserver.supportedEntryTypes)!=null&&e.includes("resource")))return!1;try{return l.observer=new PerformanceObserver(r=>{l.handleObserverEntries(r.getEntries())}),l.observer.observe({type:"resource",buffered:!0}),l.scheduleInitialReport(),!0}catch(r){return!1}}static setupFallbackCollector(){try{performance.getEntriesByType("resource");const e=()=>{if(!l.hasReportedInitial){l.hasReportedInitial=!0;try{const r=performance.getEntriesByType("resource");for(const n of r){const o=l.processResourceEntry(n);o&&l.shouldSample(o.is_error)&&l.queue.push(o)}l.flushInitialQueue()}catch(r){}}};return document.readyState==="complete"?setTimeout(e,100):window.addEventListener("load",()=>setTimeout(e,100),{once:!0}),!0}catch(e){return!1}}static handleObserverEntries(e){if(!l.stopped)try{for(const r of e)if(r.entryType==="resource"){const n=l.processResourceEntry(r);n&&l.shouldSample(n.is_error)&&(l.hasReportedInitial?l.addToQueue(n):l.queue.push(n))}}catch(r){}}static scheduleInitialReport(){const e=()=>{l.hasReportedInitial||(l.hasReportedInitial=!0,l.flushInitialQueue())};document.readyState==="complete"?setTimeout(e,100):window.addEventListener("load",()=>setTimeout(e,100),{once:!0})}static flushInitialQueue(){for(;l.queue.length>0;){const e=l.queue.splice(0,l.BATCH_SIZE);try{l.notify(y.RESOURCE_TIMING,{data:e,isInitial:!0})}catch(r){}}}static addToQueue(e){if(l.queue.push(e),e.is_error){l.flushQueue();return}l.queue.length>=l.BATCH_SIZE?l.flushQueue():l.setupFlushTimer()}static setupFlushTimer(){l.cancelFlushTimer(),l.flushTimer=setTimeout(()=>{l.flushQueue()},l.FLUSH_TIMEOUT)}static cancelFlushTimer(){l.flushTimer&&(clearTimeout(l.flushTimer),l.flushTimer=null)}static flushQueue(){if(l.queue.length!==0)for(l.cancelFlushTimer();l.queue.length>0;){const r=l.queue.splice(0,l.BATCH_SIZE);try{l.notify(y.RESOURCE_TIMING,{data:r,isInitial:!1})}catch(n){}}}static processResourceEntry(e){try{const r=`${e.name}@${e.startTime.toFixed(2)}`;if(l.processedResources.has(r)||!l.isResourceAllowed(e.name,e.initiatorType))return null;l.processedResources.add(r);const{domainLookupStart:n,domainLookupEnd:o,connectStart:i,connectEnd:s,secureConnectionStart:a,requestStart:c,responseStart:u,responseEnd:f,transferSize:h,encodedBodySize:p,decodedBodySize:m}=e,C=Math.max(0,o-n),T=Math.max(0,s-i),b=a>0?Math.max(0,s-a):0,G=Math.max(0,u-c),N=Math.max(0,f-u),B=h===0&&p===0&&m===0||e.duration===0||u===0&&f===0;return{url:e.name,initiatorType:e.initiatorType,protocol:e.nextHopProtocol,duration:Math.round(e.duration),startTime:Math.round(e.startTime),dns:Math.round(C),tcp:Math.round(T),ssl:b>0?Math.round(b):0,ttfb:Math.round(G),transfer:Math.round(N),transferSize:h||0,encodedBodySize:p||0,decodedBodySize:m||0,is_error:B}}catch(r){return null}}static shouldSample(e=!1){var r;return e||!((r=l.options)!=null&&r.sampleRate)||l.options.sampleRate>=1?!0:Math.random()<l.options.sampleRate}static isResourceAllowed(e,r){var n,o;if((n=l.options)!=null&&n.typeWhitelist&&l.options.typeWhitelist.length>0){const i=In(e,r);if(!l.options.typeWhitelist.includes(i))return!1}return!!_n(e,(o=l.options)==null?void 0:o.hostWhitelist)}};d(l,"notify",null),d(l,"options",null),d(l,"observer",null),d(l,"queue",[]),d(l,"hasReportedInitial",!1),d(l,"flushTimer",null),d(l,"stopped",!1),d(l,"processedResources",new Set),d(l,"BATCH_SIZE",10),d(l,"FLUSH_TIMEOUT",3e3);let we=l;const Mn={name:y.RESOURCE_TIMING,setup(t,e){const r=e.optionManager.get("resourceTiming");r!=null&&r.enabled&&we.start(t,r)},consume(t,e,r){On({data:e.data,ctx:t,premature:r})},dismiss(){we.stop()}};class Rn{constructor(){d(this,"dep",new Map);d(this,"watch",(e,r)=>{const n=this.dep.get(e);this.dep.set(e,n?n.concat(r):[r])});d(this,"notify",(e,...r)=>{var o;((o=this.dep.get(e))!=null?o:[]).forEach(i=>{i.call(null,...r)})})}}class $n{constructor(e){d(this,"sub",new Rn);d(this,"optionManager",L.getInstance());d(this,"configManager",new en);d(this,"reportQueue",new tn);d(this,"plugins",[]);d(this,"sender",new rn({taskQueue:this.reportQueue}));d(this,"event",E());if(!e)throw new Error("Options is required when initialize MtTrack.");if(!e.projectId&&!e.weakProjectId)throw new Error("Missing `projectId` or `weakProjectId` in initialize options.");this.optionManager.init(e)}init(){this.event.emit("beforeInit");const e=[bn],r=this.optionManager.get("resourceTiming");r!=null&&r.enabled&&e.push(Mn),this.register(e);const n=this.optionManager.get("localConfig");this.configManager.init(n),Nr(()=>this.reportQueue.recoverQueueFromStorage())}register(e){const r=Q(e),n=this.getContext();r.forEach(o=>{const i=s=>{var c,u;const a=(u=(c=o.transform)==null?void 0:c.call(o,s))!=null?u:s;if(a.ts=Date.now(),this.configManager.isReady())o.consume(n,a,!1);else{const f=()=>{o.consume(n,a,!1),this.configManager.event.off("ready",f)};this.configManager.event.on("ready",f)}o.consume(n,a,!0)};this.sub.watch(o.name,i),o.setup(this.sub.notify,n)}),this.plugins=[...r]}unregister(e){Q(e).forEach(n=>{var i,s;const o=this.plugins.findIndex(a=>typeof n=="object"?a.name===n.name:a.name===n);o>=0&&((s=(i=this.plugins[o]).dismiss)==null||s.call(i),this.plugins.splice(o,1))})}isPluginEnabled(e){let r;return typeof e=="object"&&(r=e.name),this.plugins.some(n=>n.name===r)}getContext(){return{tracker:this,reportQueue:this.reportQueue,optionManager:this.optionManager,configManager:this.configManager}}}function Ye(){return function(t,e){const r=t[e];return t[e]=function(...n){if(!!!t._tracker){w.error("MtTrack has not been initialized. Call `MtTrack.init(...)` to initialize it first.");return}r.call(t,...n)},t}}function A(t){var n,o;return(o=(n=/#.*$/.exec(t))==null?void 0:n.toString())!=null?o:null}function ye(t){var e;return!!((e=t==null?void 0:t.startsWith)!=null&&e.call(t,"#/"))}function kn(t){return ye(A(t))?"hash":"history"}function At(t,e){const r=e.split(",").map(o=>o.trim()),n=String(t);return r.includes(n)}function An(t,e){return!At(t,e)}function Dt(t,e){const r=i=>String(i).split(",").map(s=>s.trim()),n=r(t);return r(e).every(i=>n.includes(i))}function Dn(t,e){return!Dt(t,e)}function Ee(t,e){return t==e}function Pn(t,e){return!Ee(t,e)}function Pt(t,e){return re(t)>re(e)}function Hn(t,e){return Pt(t,e)||Ee(t,e)}function Ht(t,e){return re(t)<re(e)}function Nn(t,e){return Ht(t,e)||Ee(t,e)}function Nt(t){return t==null||t==""}function Bn(t){return!Nt(t)}function Fn(t,e){return new RegExp(e).test(t)}function jn(t,e){try{Fr();const r=(o,i,s,a="/")=>o.replaceAll(new RegExp(i,"g"),(c,u,f)=>f[u-1]===a?c:s).replaceAll(`${a}${i}`,i);let n=String(e);return n=r(n,"%",".*"),n=r(n,"_","."),new RegExp(n).test(String(t))}catch(r){throw r}finally{jr()}}const Bt={in:At,not_in:An,contain:Dt,not_contain:Dn,eq:Ee,neq:Pn,gt:Pt,gte:Hn,lt:Ht,lte:Nn,empty:Nt,not_empty:Bn,regex:Fn,like:jn};function Ft(t,e,r){if(r in Bt)try{return Bt[r](t,e)}catch(n){return w.error("Failed to compare.",t,e,r),!1}return w.warn(`No appropriate compare handler for type ${r} found, reject the evaluation by default`),!1}function Un(t,e){return e.replace(t,"")}function oe(t){return t==="/"?t:Un(/\/$/,t)}function X(t,e){const r=u=>I.Function(e)?e(u):e;let n=r("normal");const o=[],i=[],s=ne();t.filters.forEach(u=>{var p,m;const f=u.source.type==="property",h=(m=(p=Ve[t.trigger.type])==null?void 0:p.includes(u.source.key))!=null?m:!1;f||!h?o.push(u):i.push(u)});const a=u=>{for(let f=0;f<u.length;f++){const{source:h,type:p}=u[f];let{target:m}=u[f];const{type:C,key:T}=h;let b;switch(C){case"property":b=s[T];break;case"parameter":b=n[T],b=I.Function(b)?b():b;break}if(b=qn(T,b,n,p),m=Qn(T,m,p),Ft(b,m,p))jt(!0,{sourceType:C,sourceKey:T,sourceValue:b,compareType:p,targetValue:m});else return jt(!1,{sourceType:C,sourceKey:T,sourceValue:b,compareType:p,targetValue:m}),!1}return!0};if(w.verbose.groupCollapsed(`Evaluate event '${t.name}'`),w.verbose.log("Data:",{property:s,parameter:n}),!a(o))return w.verbose.log("Should report:",!1),w.verbose.groupEnd(),!1;if(i.length){n=r("post");const u=a(i);return w.verbose.log("Should report:",u),w.verbose.groupEnd(),u}else return!0}function qn(t,e,r,n){if(!t)return e;if(!t.startsWith("_")){if(t.startsWith("parameters.")){const[,o]=t.split("."),i=r._oParameters[o];return Number.isNaN(Number(i))?i:Number(i)}return t==="parameters"&&["contain","not_contain"].includes(n)?e.split("&"):t==="path"&&I.String(e)?oe(e):e}}function Qn(t,e,r){return t==="parameters"&&["in","not_in","contain","not_contain"].includes(r)?e.split("&"):t==="path"&&I.String(e)?oe(e):e}function jt(t,e){const{sourceType:r,sourceKey:n,sourceValue:o,compareType:i,targetValue:s}=e;w.verbose.groupCollapsed(`Filter <${r}.${n} ${i} ${s}>`),w.verbose.log("Data type:",r),w.verbose.log("Data key:",n),w.verbose.log("Source value:",o),w.verbose.log("Compare type:",i),w.verbose.log("Target value:",s),w.verbose.log("Filter passed:",t),w.verbose.groupEnd()}class Vn{constructor(e=50){d(this,"data");d(this,"capacity");this.data=new Map,this.capacity=e}set(e,r){this.data.set(e,r),this.data.size>this.capacity&&this.data.delete(this.data.keys().next().value)}get(e,r){if(this.data.has(e)){const n=this.data.get(e);return this.data.delete(e),this.data.set(e,n),n}return r}has(e){return this.data.has(e)}remove(e){return this.data.delete(e)}}function Je(t,e,r){const n=r.replace(/^#/,""),o=new URL(n,location.href);return{domain_name:oe(t+e),path:oe(o.pathname),parameters:je(o.search),_oParameters:Ue(o.search)}}function ve(t=window.location){return{domain_name:t.host,path:oe(t.pathname),parameters:je(t.search),_oParameters:Ue(t.search)}}const Ze=new Vn;function Se(){if(Ze.has(location.href))return Ze.get(location.href);const t=A(location.href),e=t&&ye(t)?Je(location.host,location.pathname,t):ve();return Ze.set(location.href,e),e}const Wn=3e3,Ut=t=>{const{type:e,configs:r,data:n,ctx:o}=t;if(!(r!=null&&r.length))return;const i={hash:Gn,history:Kn};r.forEach(async s=>{const a=i[e](n);if(X(s,a)){const c=o.optionManager.get("projectId"),u=location.href,f=await j(s,a,{projectId:c,ts:n.ts});o.reportQueue.pushAsync({promise:Ar(Wn).then(()=>j(s,a,{projectId:c,ts:n.ts})).then(h=>{const p=location.href;return u===p?h:f}),getFallback:()=>f})}})};function qt(t){return t||document.referrer||null}function Gn(t){return S(g({},Je(location.host,location.pathname,t.toHash)),{refer_url:qt(t.from)})}function Kn(t){const e=new URL(t.to);return S(g({},ve(e)),{refer_url:qt(t.from)})}class zn{constructor(){d(this,"value",null)}start(){this.value=Date.now()}stop(){this.value=null}get(){return this.value===null?0:Date.now()-this.value}reset(e=!1){this.stop(),e&&this.start()}}const Te=new zn,be=t=>{const{configs:e,data:r,ctx:n}=t;if(!(e!=null&&e.length)||!r.from)return;const o=new URL(r.from),s=S(g({},{hash:()=>Je(o.host,o.pathname,o.hash),history:()=>ve(o)}[kn(r.from)]()),{to_url:r.to,viewport_position:window.scrollY,event_duration:Te.get()});Te.reset(!0),e.forEach(async a=>{if(X(a,s)){const c=n.optionManager.get("projectId"),u=await j(a,s,{projectId:c,ts:r.ts});n.reportQueue.push(u)}})},Qt={pageEnter:_.PAGE_ENTER,pageLeave:_.PAGE_LEAVE},Xn={name:y.HASH_CHANGE,setup(t){const e=(r,n)=>{const o=A(n);if(!o||!ye(o))return;const i={from:r,to:n};t(y.HASH_CHANGE,i)};window.addEventListener("hashchange",r=>e(r.oldURL,r.newURL)),window.addEventListener("x-hashchange",r=>e(r.detail.oldURL,r.detail.newURL))},transform(t){return S(g({},t),{fromHash:A(t.from),toHash:A(t.to)})},consume(t,e,r){const n=F(t.configManager,r);Ut({type:"hash",configs:n(Qt.pageEnter),data:e,ctx:t}),be({configs:n(Qt.pageLeave),data:e,ctx:t})}};function Yn(t,e){const r=A(e.to);let n=r&&ye(r)?y.HASH_CHANGE:y.HISTORY_CHANGE;t(n,e)}let et=location.href;const tt=[],Y={pushState:null,replaceState:null};function Vt(t){tt.forEach(e=>e(t))}function Jn(t,e){const r=new CustomEvent("x-hashchange",{detail:{oldURL:t,newURL:e}});window.dispatchEvent(r)}function Wt(t){return function(...e){const r=location.href;t.apply(this,e),et=location.href;const n={from:r,to:location.href};if(n.from===n.to)return;const o=A(n.from),i=A(n.to);o!==i&&Jn(n.from,n.to),Vt(n)}}function Gt(){const t=location.href,e={from:et,to:t};e.from!==e.to&&(location.href.indexOf("#/")>=0||(et=t,Vt(e)))}function Zn(){Y.pushState=window.history.pushState,Y.replaceState=window.history.replaceState,window.history.pushState=Wt(window.history.pushState),window.history.replaceState=Wt(window.history.replaceState),window.addEventListener("popstate",Gt)}function eo(){tt.length=0,window.history.pushState=Y.pushState,window.history.replaceState=Y.replaceState,Y.pushState=null,Y.replaceState=null,window.removeEventListener("popstate",Gt)}function to(t){tt.push(t)}const rt={enable:Zn,dismiss:eo,listen:to},Kt={pageEnter:_.PAGE_ENTER,pageLeave:_.PAGE_LEAVE};let zt=!1;const ro={name:y.HISTORY_CHANGE,setup(t){rt.enable(),rt.listen(e=>{t(y.HISTORY_CHANGE,e)}),zt||(Yn(t,{from:null,to:location.href}),zt=!0)},async consume(t,e,r){const n=F(t.configManager,r);Ut({type:"history",configs:n(Kt.pageEnter),data:e,ctx:t}),be({configs:n(Kt.pageLeave),data:e,ctx:t})},dismiss(){rt.dismiss()}};class Xt{parse(e,r){switch(e){case"eq":return this.eq(r);case"in":return this.in(r);case"contain":return this.contain(r);default:return{type:"_ignore"}}}eq(e){return{type:"or",values:[e]}}in(e){return{type:"or",values:e.split(",")}}}class no extends Xt{contain(e){const r=e.split(",");return r.length?{type:"and",values:r}:{type:"_ignore"}}}class oo extends Xt{contain(e){const r=e.split(",");return r.length===1?{type:"and",values:r}:{type:"_ignore"}}}class io{getSelector(e,r){switch(e){case"id":return`#${r}`;case"class":return`.${r}`;case"tag":return r;case"name":return`[name=${r}]`}}formatSelector(e,r){let n;switch(e){case"and":n=r.join("");break;case"or":n=r;break;default:n=[]}return Q(n)}permutate(e){const r=[],n=[];if(!e.length)return[];const o=(i,s=0)=>{i[s].forEach(a=>{r[s]=a,s+1<i.length?o(i,s+1):n.push(Array.from(r))})};return o(e),n}compose(e){if([...e.values()].some(a=>a.type==="_invalid"))return null;const i=["tag","id","class","name"].reduce((a,c)=>{const u=e.get(c);if(u&&u.values&&u.type!=="_ignore"){const f=this.formatSelector(u.type,u.values.map(h=>this.getSelector(c,h)));a.push(f)}return a},[]);return this.permutate(i).map(a=>a.join("")).join(",")}}const Yt={element_id:"id",element_class_name:"class",element_type:"tag",element_name:"name"};class Jt{constructor(e){d(this,"filters");d(this,"parsers");d(this,"composer");this.filters=e,this.parsers={single:new oo,list:new no},this.composer=new io}getLatestFilterOf(e){var r;return(r=this.filters.filter(n=>n.source.type==="parameter"&&n.source.key===e).pop())!=null?r:null}getDescriptorByFilter(e){const{type:r,target:n,source:{key:o}}=e,i=o==="element_class_name"?this.parsers.list:this.parsers.single;return n==null?{type:"_ignore"}:i.parse(r,n.toString())}getDescriptorMap(){return Object.keys(Yt).reduce((e,r)=>{const n=this.getLatestFilterOf(r),o=Yt[r];return n&&o&&e.set(o,this.getDescriptorByFilter(n)),e},new Map)}build(){const e=this.getDescriptorMap();return this.composer.compose(e)}}function Oe(t){return{element_id:()=>t.getAttribute("id"),element_content:()=>Et(t,t.tagName),element_class_name:()=>t.classList.value.length?Array.from(t.classList.value.split(" ")).toString():null,element_type:()=>t.tagName.toLowerCase(),element_name:()=>t.getAttribute("name"),element_target_url:()=>t.tagName==="A"?t.getAttribute("href"):null,element_code:()=>t.outerHTML,_target:t}}function Zt(t,e){const r=new Jt(e).build(),n=document.querySelectorAll(r||"*"),o=e.filter(s=>s.source.key.startsWith("element_")&&s.source.key!=="element_index");let i=0;for(let s=0;s<n.length;s+=1){const a=n[s],c=Oe(a);let u=!0;for(let f=0;f<o.length;f+=1){const h=o[f];let p=c[h.source.key];if(!Ft(I.Function(p)?p():p,h.target,h.type)){u=!1;break}}if(u){if(a===t)return i+1;i+=1}}return null}function so(t){let e=t,r=0,n=0;for(;e;)r+=e.offsetTop,n+=e.offsetLeft,e=e.offsetParent;return{top:r,left:n}}const ao=t=>{const{configs:e,data:r,ctx:n}=t;e!=null&&e.length&&e.forEach(o=>{We.add(async()=>{let i=r.target;for(;i;){const s=co(S(g({},r),{target:i}));if(X(o,c=>(c==="post"&&(s.element_index=Zt(i,o.filters)),s))){const c=n.optionManager.get("projectId"),u=await j(o,s,{projectId:c,ts:r.ts});n.reportQueue.push(u);break}i=i.parentElement}})})};function co(t){const e=Se(),r=Oe(t.target);return S(g(g({},e),r),{page_x:t.pageX,page_y:t.pageY})}const uo={click:_.CLICK},lo={name:y.CLICK,setup(t){document.addEventListener("click",e=>{const r={target:e.target,pageX:e.pageX,pageY:e.pageY};t(y.CLICK,r)},{capture:!0,passive:!0})},consume(t,e,r){const n=F(t.configManager,r);ao({configs:n(uo.click),data:e,ctx:t})}};function er(t,e,r){return e<=r?100:Math.round(t/(e-r)*100)}const fo=t=>{const{configs:e,data:r,ctx:n}=t;e!=null&&e.length&&e.forEach(async o=>{const i=po(r);if(X(o,i)){const s=n.optionManager.get("projectId"),a=await j(o,i,{projectId:s,ts:r.ts});n.reportQueue.push(a)}})};function po(t){const e=Se(),r=Oe(t.target);return S(g(g({},e),r),{x_scrolled:t.scrollXPercent,y_scrolled:t.scrollYPercent})}const ho={scroll:_.SCROLL},go={name:y.SCROLL,setup(t){document.addEventListener("scroll",Dr(e=>{let r=e.target instanceof Document?e.target.scrollingElement:e.target;if(!r)return;const n={target:r,clientWidth:r.clientWidth,clientHeight:r.clientHeight,scrollTop:r.scrollTop,scrollLeft:r.scrollLeft,scrollWidth:r.scrollWidth,scrollHeight:r.scrollHeight};t(y.SCROLL,n)},200),{capture:!0,passive:!0})},transform(t){const{scrollLeft:e,scrollWidth:r,clientWidth:n,scrollTop:o,scrollHeight:i,clientHeight:s}=t,a=er(e,r,n),c=er(o,i,s);return S(g({},t),{scrollXPercent:a,scrollYPercent:c})},consume(t,e,r){const n=F(t.configManager,r);fo({configs:n(ho.scroll),data:e,ctx:t})}};class tr{constructor(){d(this,"event",E());d(this,"data",{})}set(e,r,n){return Reflect.set(e,r,n)}}function mo(t){const r=Object.values(Be).concat(Fe()).some(o=>t.url.startsWith(o)),n=/akmweb\.youngjoygame\.com\/web\/gms\/\w+_\d+_\d*\.json/.test(t.url);return r||n}function wo(t){const e=r=>Object.prototype.toString.call(r);if(t===null)return null;if(I.String(t))return t;if(t instanceof FormData){const r={};return t.forEach((n,o)=>{r[o]=I.String(n)?n:e(n)}),JSON.stringify(r)}return e(t)}function yo(t){const e={};return t.split(`
`).forEach(n=>{const o=n.trim();if(o){const[i,s]=o.split(": ");i&&s!==void 0&&(e[i.toLowerCase()]=s)}}),e}function Eo(t){const e={};return t&&(t instanceof Headers?t.forEach((r,n)=>{e[n.toLowerCase()]=r}):Array.isArray(t)?t.forEach(([r,n])=>{e[r.toLowerCase()]=n}):Object.entries(t).forEach(([r,n])=>{e[r.toLowerCase()]=n})),e}function vo(t){const e={};return t.forEach((r,n)=>{e[n.toLowerCase()]=r}),e}class So extends tr{constructor(r){super();d(this,"originalSetRequestHeader",null);this.xhr=r,this.data._type="xhr",this.handleReadyStateChange=this.handleReadyStateChange.bind(this),r.addEventListener("readystatechange",this.handleReadyStateChange),this.originalSetRequestHeader=this.enhanceSetRequestHeader(r.setRequestHeader)}get(r,n){switch(n){case"open":return this.handleOpen(r);case"send":return this.handleSend(r);case"setRequestHeader":return Reflect.has(r,"_customSetRequestHeader")?Reflect.get(r,"_customSetRequestHeader"):(i,s)=>(this.data.requestHeaders||(this.data.requestHeaders={}),this.data.requestHeaders[i]=s,this.originalSetRequestHeader?this.originalSetRequestHeader(i,s):r.setRequestHeader(i,s));default:const o=Reflect.get(r,n);return I.Function(o)?o.bind(r):o}}set(r,n,o){return n==="setRequestHeader"?(Reflect.set(r,"_customSetRequestHeader",this.enhanceSetRequestHeader(o)),!0):Reflect.set(r,n,o)}enhanceSetRequestHeader(r){return(n,o)=>(this.data.requestHeaders||(this.data.requestHeaders={}),this.data.requestHeaders[n]=o,r.apply(this.xhr,[n,o]))}handleOpen(r){const n=Reflect.get(r,"open");return(...o)=>{const[i,s]=o;return this.data.method=i,this.data.url=s.toString(),n.apply(r,o)}}handleSend(r){const n=Reflect.get(r,"send");return(...o)=>{var s;const[i]=o;return this.data.requestBody=(s=i==null?void 0:i.toString())!=null?s:null,n.apply(r,o)}}handleReadyStateChange(){switch(this.xhr.readyState){case XMLHttpRequest.OPENED:this.data.startTime=Date.now();break;case XMLHttpRequest.DONE:const r=Date.now(),n=this.xhr.getAllResponseHeaders();this.data=S(g({},this.data),{endTime:r,duration:r-this.data.startTime,responseBody:null,responseHeaders:yo(n),status:this.xhr.status,statusText:this.xhr.statusText}),this.event.emit("network",this.data),this.xhr.removeEventListener("readystatechange",this.handleReadyStateChange)}}}const ae=class ae{static enable(){XMLHttpRequest=new Proxy(this.origin,{construct(e){const r=new e,n=new So(r);return n.event.on("network",o=>ae.trigger(o)),new Proxy(r,n)}})}static trigger(e){this.listeners.forEach(r=>r(e))}static listen(e){this.listeners.push(e)}static unlisten(e){this.listeners=e?this.listeners.filter(r=>r!==e):[]}static dismiss(){XMLHttpRequest=this.origin}};d(ae,"listeners",[]),d(ae,"origin",XMLHttpRequest);let J=ae,To=0;class bo extends tr{constructor(){super();d(this,"dataMap",{});this.data._type="fetch",this.parseResponse=this.parseResponse.bind(this)}apply(r,n,o){const[i,s]=o,a=To++;return this.parseRequest(a,i,s),Reflect.apply(r,n,o).then(c=>this.parseResponse(a,c),c=>{throw this.parseError(a,c),c})}parseRequest(r,n,o){var a,c,u;const i="GET",s=this.dataMap[r]=this.dataMap[r]||{};switch(!0){case I.String(n):s.url=n,s.method=(a=o==null?void 0:o.method)!=null?a:i;break;case n instanceof URL:s.url=n.href,s.method=(c=o==null?void 0:o.method)!=null?c:i;break;default:s.url=n.url,s.method=n.method}s.startTime=Date.now(),s.requestHeaders=Eo(o==null?void 0:o.headers),s.requestBody=wo((u=o==null?void 0:o.body)!=null?u:null)}parseResponse(r,n){const o=n.clone(),i=Date.now();let s=this.dataMap[r];return s=S(g({},s),{endTime:i,duration:i-s.startTime,status:n.status,statusText:n.statusText,responseHeaders:vo(n.headers)}),o.text().then(a=>{s.responseBody=null,this.event.emit("network",s),delete this.dataMap[r],s=null}),n}parseError(r,n){const o=Date.now(),i=this.dataMap[r];if(i){const s=S(g({},i),{endTime:o,duration:o-i.startTime,status:0,statusText:n.message||"Network Error",responseHeaders:{},responseBody:null,_isError:!0,_error:{message:n.message||"Network request failed",stack:n.stack||""}});this.event.emit("network",s),delete this.dataMap[r]}}}const ce=class ce{static enable(){const e=new bo;window.fetch=new Proxy(this.origin,e),e.event.on("network",r=>ce.trigger(r))}static trigger(e){this.listeners.forEach(r=>r(e))}static listen(e){this.listeners.push(e)}static unlisten(e){this.listeners=e?this.listeners.filter(r=>r!==e):[]}static dismiss(){window.fetch=this.origin}};d(ce,"listeners",[]),d(ce,"origin",window.fetch);let Z=ce;const Oo=async t=>{const{configs:e,data:r,ctx:n,premature:o}=t,i=n.optionManager.get("projectId"),s=Io(r);if(e!=null&&e.length)return e.forEach(async f=>{if(X(f,s)){const h=await j(f,s,{projectId:i,ts:r.ts});n.reportQueue.push(h)}});if(!o||!n.optionManager.get("autoReportNetwork"))return;const c={name:y.NETWORK,mode:"remote",trigger:{type:_.NETWORK,_reportParameterSet:new Set,_postCheckParameters:[]},filters:[],extra:[]},u=await Mt(c,s,{projectId:i,ts:r.ts});n.reportQueue.push(u)};function Io(t){var r,n;const e=ve(t.url);return S(g({},e),{mode:t.method,statusCode:t.status,statusText:t.statusText,requestBody:t.requestBody,responseBody:t.responseBody,requestHeaders:(r=t.requestHeaders)!=null?r:{},responseHeaders:(n=t.responseHeaders)!=null?n:{},time:t.duration})}const xo={network:_.NETWORK},_o={name:y.NETWORK,setup(t){const e=r=>{mo(r)||t(y.NETWORK,r)};J.enable(),J.listen(e),Z.enable(),Z.listen(e)},transform(t){const e=new URL(t.url,location.href);return S(g({},t),{url:e})},consume(t,e,r){const n=F(t.configManager,r);Oo({configs:n(xo.network),data:e,ctx:t,premature:r})},dismiss(){J.unlisten(),J.dismiss(),Z.unlisten(),Z.dismiss()}},Co={pageLeave:_.PAGE_LEAVE},Lo={name:y.UNLOAD,setup(t,e){window.addEventListener(de(),()=>{const r={url:location.href,ts:Date.now()};t(y.UNLOAD,r)}),e.reportQueue.reSetupUnloadFlushListener()},consume(t,e,r){const n=F(t.configManager,r);be({configs:n(Co.pageLeave),data:{from:e.url,fromHash:A(e.url),to:null,toHash:null},ctx:t})}},Mo={pageLeave:_.PAGE_LEAVE},Ro={name:y.VISIBILITY_CHANGE,setup(t){document.addEventListener("visibilitychange",()=>{const e=!document.hidden,r={url:location.href,ts:Date.now(),visible:e};e&&Te.reset(!0),t(y.VISIBILITY_CHANGE,r)})},consume(t,e,r){const n=F(t.configManager,r);e.visible||be({configs:n(Mo.pageLeave),data:{from:e.url,fromHash:A(e.url),to:null,toHash:null},ctx:t})}},$o=t=>{const{configs:e,data:r,ctx:n}=t,o=r.target;e!=null&&e.length&&o._intersectionConfig.forEach(async i=>{const s=ko(S(g({},r),{target:r.target}));if(X(i,c=>(c==="post"&&(s.element_index=Zt(r.target,i.filters)),s))){const c=n.optionManager.get("projectId"),u=await j(i,s,{projectId:c,ts:r.ts});o._intersectionConfig.delete(i),n.reportQueue.push(u)}})};function ko(t){const e=t.target,r=Se(),n=Oe(e),{left:o,top:i}=so(e);return S(g(g({},r),n),{page_x:o,page_y:i})}class Ao{constructor(){d(this,"observer");d(this,"event",E());this.handler=this.handler.bind(this),this.observer=new MutationObserver(this.handler),this.observer.observe(document.body,{childList:!0,subtree:!0})}handler(e){e.forEach(r=>{if(r.type!=="childList")return;const{addedNodes:n,removedNodes:o}=r,i=(s,a)=>s.forEach(c=>{c instanceof HTMLElement&&(this.event.emit(a,c),c.children.length&&i(c.childNodes,a))});i(n,"inserted"),i(o,"removed")})}}const nt="_intersectionConfig",rr=.5;class Do{constructor(e=rr){d(this,"observer");d(this,"elements",new Set);d(this,"inviewElements",new Set);d(this,"event",E());this.handler=this.handler.bind(this),this.observer=new IntersectionObserver(this.handler,{threshold:this.formatThreshold(e)})}formatThreshold(e=0){return Array.from(new Set([0,...Q(e)]))}handler(e){e.forEach(r=>{r.intersectionRatio>0&&this.inviewElements.add(r.target),r.intersectionRatio<=0&&this.inviewElements.delete(r.target),r.intersectionRatio>=rr&&this.event.emit("appear",r.target)})}add(e,r){e[nt]||(e[nt]=new Set),e[nt].add(r),this.elements.add(e),this.observer.observe(e)}remove(e){this.elements.delete(e),this.observer.unobserve(e)}has(e){return this.elements.has(e)}}function Po(t){return new Jt(t.filters).build()}const Ho={scan:_.SCAN},No={name:y.SCAN,setup(t,e){e.configManager.event.on("ready",()=>this.handleConfigReady(t,e))},handleConfigReady(t,e){const r=e.configManager.getConfigByTriggerType(_.SCAN,"all");if(!(r!=null&&r.length))return;const n=new Ao,o=new Do,i=new Map(r.reduce((s,a)=>{const c=Po(a);return c&&s.push([a,c]),s},[]));i.forEach((s,a)=>{try{document.querySelectorAll(s).forEach(c=>{o.add(c,a)})}catch(c){w.warn(`Invalid selector: '${s}', config:`,a)}}),n.event.on("inserted",s=>{i.forEach((a,c)=>{try{s.matches(a)&&o.add(s,c)}catch(u){w.warn(`Invalid selector: '${a}', config:`,c)}})}),n.event.on("removed",s=>{o.has(s)&&o.remove(s)}),o.event.on("appear",s=>{const a={target:s};t(y.SCAN,a)}),document.addEventListener("scroll",Pr(()=>{o.inviewElements.forEach(s=>{if(!(s instanceof HTMLElement))return;const{x:a,y:c}=s.getBoundingClientRect(),u={target:s};s.offsetHeight>=window.innerHeight&&c<window.innerHeight/2&&t(y.SCAN,u),s.offsetWidth>=window.innerWidth&&a<window.innerWidth/2&&t(y.SCAN,u)})}),{capture:!0,passive:!0})},consume(t,e,r){const n=F(t.configManager,r);$o({configs:n(Ho.scan),data:e,ctx:t})}};class ot{static prepareReportData(e){var a,c,u;if(!this.metaEvent)throw new Error("metaEvent is not defined.");const{eventName:r,parameters:n={},did:o="",project:i=0}=e,s=ne();return{type:"event",did:o,uuid:pe(),session_id:he(),page_view_id:ge(),meta_event:this.metaEvent,project:i,properties:{event_name:r,time:Date.now(),timeOffset:Number.parseInt(String((u=(c=(a=window.performance)==null?void 0:a.now)==null?void 0:c.call(a))!=null?u:0)),property:s,parameter:n,extra:g({},k.getAll())}}}static send(e){It(Q(e))}}d(ot,"metaEvent",null);const Bo="__built_in_tracks__";class nr extends ot{static init(){this.trackSdkInitComplete(),this.trackFingerprintLoad(),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&this.trackPageHide()}),window.addEventListener(de(),()=>{this.trackPageUnload()})}static trackSdkInitComplete(){const r=L.getInstance().get("projectId"),n=this.prepareReportData({eventName:"__init_complete__",did:M.get(le),project:typeof r=="number"?r:void 0});this.send(n)}static async trackFingerprintLoad(){const r=L.getInstance().get("projectId"),n=this.prepareReportData({eventName:"__fp_load__",did:await K(),project:typeof r=="number"?r:void 0});this.send(n)}static async trackPageHide(){const e=L.getInstance(),r=Ae(),n=this.prepareReportData({eventName:"__page_hide__",did:await K(),project:await e.get("projectId"),parameters:{duration:Date.now()-r}});this.send(n)}static async trackPageUnload(){const e=L.getInstance(),r=Ae(),n=this.prepareReportData({eventName:"__page_unload__",did:await K(),project:await e.get("projectId"),parameters:{duration:Date.now()-r}});this.send(n)}}d(nr,"metaEvent",Bo);var it,or=-1,ee=function(t){addEventListener("pageshow",function(e){e.persisted&&(or=e.timeStamp,t(e))},!0)},st=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},Ie=function(){var t=st();return t&&t.activationStart||0},D=function(t,e){var r=st(),n="navigate";return or>=0?n="back-forward-cache":r&&(document.prerendering||Ie()>0?n="prerender":document.wasDiscarded?n="restore":r.type&&(n=r.type.replace(/_/g,"-"))),{name:t,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:n}},ie=function(t,e,r){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var n=new PerformanceObserver(function(o){Promise.resolve().then(function(){e(o.getEntries())})});return n.observe(Object.assign({type:t,buffered:!0},r||{})),n}}catch(o){}},P=function(t,e,r,n){var o,i;return function(s){e.value>=0&&(s||n)&&((i=e.value-(o||0))||o===void 0)&&(o=e.value,e.delta=i,e.rating=function(a,c){return a>c[1]?"poor":a>c[0]?"needs-improvement":"good"}(e.value,r),t(e))}},at=function(t){requestAnimationFrame(function(){return requestAnimationFrame(function(){return t()})})},ct=function(t){var e=function(r){r.type!=="pagehide"&&document.visibilityState!=="hidden"||t(r)};addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0)},ir=function(t){var e=!1;return function(r){e||(t(r),e=!0)}},te=-1,sr=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},xe=function(t){document.visibilityState==="hidden"&&te>-1&&(te=t.type==="visibilitychange"?t.timeStamp:0,Fo())},ar=function(){addEventListener("visibilitychange",xe,!0),addEventListener("prerenderingchange",xe,!0)},Fo=function(){removeEventListener("visibilitychange",xe,!0),removeEventListener("prerenderingchange",xe,!0)},cr=function(){return te<0&&(te=sr(),ar(),ee(function(){setTimeout(function(){te=sr(),ar()},0)})),{get firstHiddenTime(){return te}}},_e=function(t){document.prerendering?addEventListener("prerenderingchange",function(){return t()},!0):t()},ur=[1800,3e3],lr=function(t,e){e=e||{},_e(function(){var r,n=cr(),o=D("FCP"),i=ie("paint",function(s){s.forEach(function(a){a.name==="first-contentful-paint"&&(i.disconnect(),a.startTime<n.firstHiddenTime&&(o.value=Math.max(a.startTime-Ie(),0),o.entries.push(a),r(!0)))})});i&&(r=P(t,o,ur,e.reportAllChanges),ee(function(s){o=D("FCP"),r=P(t,o,ur,e.reportAllChanges),at(function(){o.value=performance.now()-s.timeStamp,r(!0)})}))})},dr=[.1,.25],jo=function(t,e){e=e||{},lr(ir(function(){var r,n=D("CLS",0),o=0,i=[],s=function(c){c.forEach(function(u){if(!u.hadRecentInput){var f=i[0],h=i[i.length-1];o&&u.startTime-h.startTime<1e3&&u.startTime-f.startTime<5e3?(o+=u.value,i.push(u)):(o=u.value,i=[u])}}),o>n.value&&(n.value=o,n.entries=i,r())},a=ie("layout-shift",s);a&&(r=P(t,n,dr,e.reportAllChanges),ct(function(){s(a.takeRecords()),r(!0)}),ee(function(){o=0,n=D("CLS",0),r=P(t,n,dr,e.reportAllChanges),at(function(){return r()})}),setTimeout(r,0))}))},fr=0,ut=1/0,Ce=0,Uo=function(t){t.forEach(function(e){e.interactionId&&(ut=Math.min(ut,e.interactionId),Ce=Math.max(Ce,e.interactionId),fr=Ce?(Ce-ut)/7+1:0)})},pr=function(){return it?fr:performance.interactionCount||0},qo=function(){"interactionCount"in performance||it||(it=ie("event",Uo,{type:"event",buffered:!0,durationThreshold:0}))},hr=[200,500],gr=0,mr=function(){return pr()-gr},H=[],lt={},wr=function(t){var e=H[H.length-1],r=lt[t.interactionId];if(r||H.length<10||t.duration>e.latency){if(r)r.entries.push(t),r.latency=Math.max(r.latency,t.duration);else{var n={id:t.interactionId,latency:t.duration,entries:[t]};lt[n.id]=n,H.push(n)}H.sort(function(o,i){return i.latency-o.latency}),H.splice(10).forEach(function(o){delete lt[o.id]})}},Qo=function(t,e){e=e||{},_e(function(){var r;qo();var n,o=D("INP"),i=function(a){a.forEach(function(f){f.interactionId&&wr(f),f.entryType==="first-input"&&!H.some(function(h){return h.entries.some(function(p){return f.duration===p.duration&&f.startTime===p.startTime})})&&wr(f)});var c,u=(c=Math.min(H.length-1,Math.floor(mr()/50)),H[c]);u&&u.latency!==o.value&&(o.value=u.latency,o.entries=u.entries,n())},s=ie("event",i,{durationThreshold:(r=e.durationThreshold)!==null&&r!==void 0?r:40});n=P(t,o,hr,e.reportAllChanges),s&&("PerformanceEventTiming"in window&&"interactionId"in PerformanceEventTiming.prototype&&s.observe({type:"first-input",buffered:!0}),ct(function(){i(s.takeRecords()),o.value<0&&mr()>0&&(o.value=0,o.entries=[]),n(!0)}),ee(function(){H=[],gr=pr(),o=D("INP"),n=P(t,o,hr,e.reportAllChanges)}))})},yr=[2500,4e3],dt={},Vo=function(t,e){e=e||{},_e(function(){var r,n=cr(),o=D("LCP"),i=function(c){var u=c[c.length-1];u&&u.startTime<n.firstHiddenTime&&(o.value=Math.max(u.startTime-Ie(),0),o.entries=[u],r())},s=ie("largest-contentful-paint",i);if(s){r=P(t,o,yr,e.reportAllChanges);var a=ir(function(){dt[o.id]||(i(s.takeRecords()),s.disconnect(),dt[o.id]=!0,r(!0))});["keydown","click"].forEach(function(c){addEventListener(c,function(){return setTimeout(a,0)},!0)}),ct(a),ee(function(c){o=D("LCP"),r=P(t,o,yr,e.reportAllChanges),at(function(){o.value=performance.now()-c.timeStamp,dt[o.id]=!0,r(!0)})})}})},Er=[800,1800],Wo=function t(e){document.prerendering?_e(function(){return t(e)}):document.readyState!=="complete"?addEventListener("load",function(){return t(e)},!0):setTimeout(e,0)},Go=function(t,e){e=e||{};var r=D("TTFB"),n=P(t,r,Er,e.reportAllChanges);Wo(function(){var o=st();if(o){var i=o.responseStart;if(i<=0||i>performance.now())return;r.value=Math.max(i-Ie(),0),r.entries=[o],n(!0),ee(function(){r=D("TTFB",0),(n=P(t,r,Er,e.reportAllChanges))(!0)})}})};function Ko(){return new Promise(t=>{lr(t)})}function zo(){let t;const e=(r,n)=>{t&&clearTimeout(t);const{domComplete:o}=r,i=o||performance.timing.loadEventStart-performance.timing.navigationStart;if(i>0){n(i);return}t=setTimeout(()=>{e(r,n)},100)};return new Promise((r,n)=>{var o;try{const i=new PerformanceObserver(s=>{s.getEntries().forEach(a=>{e(a,c=>{i.disconnect(),r({value:c})})})});((o=PerformanceObserver.supportedEntryTypes)==null?void 0:o.indexOf("navigation"))>=0&&i.observe({type:"navigation",buffered:!0})}catch(i){n(i)}})}let vr=0,Sr=!1,Tr,Le,W=[];function br(t){cancelAnimationFrame(Tr),Tr=requestAnimationFrame(()=>{if(document.readyState==="complete"&&(Sr=!0),Sr){Le&&Le.disconnect();const e=new Date().getTime();vr=Xo(e),W=null,t&&t({value:vr})}else br(t)})}function Xo(t){let e=0;return W==null||W.forEach(r=>{r.startTime>e&&(e=r.startTime)}),(e||t)-performance.timing.navigationStart}const Yo=window.innerWidth,Jo=window.innerHeight;function Or(t){if(!(t instanceof HTMLElement)&&!(t instanceof SVGElement))return!1;const e=t.getBoundingClientRect();return e.left<Yo&&e.top<Jo}function Zo(){let t=null;const e=new Promise(n=>{t=n}),r=["STYLE","SCRIPT","LINK"];return Le=new MutationObserver(n=>{br(t);const o={children:[],startTime:0};for(const i of n)if(i.addedNodes.length&&Or(i.target))for(const s of Array.from(i.addedNodes)){const{nodeType:a,tagName:c}=s;a===1&&!r.includes(String(c))&&Or(s)&&o.children.push(s)}o.children.length&&(W==null||W.push(o),o.startTime=new Date().getTime())}),Le.observe(document,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),e}function ei(){return new Promise(t=>{Vo(t)})}function ti(){return new Promise(t=>{Qo(t)})}function ri(){return new Promise(t=>{jo(t)})}const Ir={value:0};function ni(){return new Promise(t=>{const e=()=>{var n;if(typeof PerformanceObserver<"u"&&((n=PerformanceObserver.supportedEntryTypes)!=null&&n.includes("navigation")))try{const o=new PerformanceObserver(i=>{const s=i.getEntries();s.length>0&&(o.disconnect(),t(xr(s[0])))});o.observe({type:"navigation",buffered:!0});return}catch(o){}if(typeof performance<"u"&&performance.getEntriesByType)try{const o=performance.getEntriesByType("navigation");if(o&&o.length>0){t(xr(o[0]));return}}catch(o){}const r=oi();t(r)};document.readyState==="complete"?setTimeout(e,100):window.addEventListener("load",()=>setTimeout(e,100),{once:!0})})}function xr(t){if(t.type==="back_forward")return Ir;const{transferSize:e,encodedBodySize:r,decodedBodySize:n}=t;return S(g({},_r(t)),{transferSize:e||0,encodedBodySize:r||0,decodedBodySize:n||0})}function oi(){const t=performance.timing;return t?_r(t):Ir}function _r(t){const{fetchStart:e,domainLookupStart:r,domainLookupEnd:n,redirectStart:o,redirectEnd:i,connectStart:s,connectEnd:a,secureConnectionStart:c,requestStart:u,responseStart:f,responseEnd:h,domInteractive:p,domContentLoadedEventEnd:m,loadEventStart:C}=t;return{value:1,firstByte:f-r,domReady:m-e,loadEvent:C-e,redirect:i-o,dns:n-r,tcp:a-s,ssl:c>0?a-c:0,ttfb:f-u,transfer:h-f,domParse:p-h,resourceDownload:C-m,transferSize:0,encodedBodySize:0,decodedBodySize:0}}let U={isTracking:!0,hasReported:!1,listenersAdded:!1},Me=null;const ii=15e3;function si(){var t,e,r,n;U.listenersAdded||((t=$.getTracker())==null||t.sub.watch(y.CLICK,ai),(e=$.getTracker())==null||e.sub.watch(y.SCROLL,ci),(r=$.getTracker())==null||r.sub.watch(y.UNLOAD,ui),(n=$.getTracker())==null||n.sub.watch(y.VISIBILITY_CHANGE,li),U.listenersAdded=!0)}function ai(){Re("click")}function ci(){Re("scroll")}function ui(){Re("pagehide")}function li(){document.visibilityState==="hidden"&&Re("visibilitychange")}function Re(t){if(!U.isTracking||U.hasReported)return;const e=Date.now()-performance.timing.loadEventStart;if(e>ii){U.isTracking=!1,U.hasReported=!0;return}U.hasReported=!0,U.isTracking=!1,Me&&(Me({value:e,trigger:t,duration:e,pageStartTime:performance.timing.navigationStart,loadEventTime:performance.timing.loadEventStart}),Me=null)}let Cr=!1;function di(){Cr||(Cr=!0,si())}function fi(){return di(),new Promise(t=>{Me=t})}function pi(){return new Promise(t=>{Go(t)})}const hi="__performance_tracks__",gi=t=>Math.round(t*100)/100;class Lr extends ot{static init(){new Map([["__fp__",Ko],["__lcp__",ei],["__domComplete__",zo],["__fsp__",Zo],["__inp__",ti],["__cls__",ri],["__TTFB__",pi],["__first_screen_stay__",fi],["__navigation_timing__",ni]]).forEach((r,n)=>{r().then(o=>{const i=gi(o.value),s=S(g({},o),{data:i});if(n==="__cls__")return this.trackAttribute(n,s);i>0&&this.trackAttribute(n,s)})})}static trackAttribute(e,r){const o=L.getInstance().get("projectId"),i=this.prepareReportData({eventName:e,did:M.get(le),project:typeof o=="number"?o:void 0,parameters:r});this.send(i)}}d(Lr,"metaEvent",hi);class mi{constructor(){d(this,"activeMeasures",new Map);d(this,"prefix","_mt_")}startMeasure(e,r){if(!e||typeof e!="string")return console.error("[PerformanceMeasure] Invalid measure name"),0;const n=`${this.prefix}${e}_start`,o=performance.now();try{return performance.mark(n),this.activeMeasures.set(e,{startTime:o,extra:r}),o}catch(i){return console.error(`[PerformanceMeasure] Failed to start measure "${e}":`,i),o}}endMeasure(e,r){if(!e||typeof e!="string")return console.error("[PerformanceMeasure] Invalid measure name"),null;const n=`${this.prefix}${e}_start`,o=`${this.prefix}${e}_end`,i=`${this.prefix}${e}`;try{const s=performance.now();performance.mark(o);const a=this.activeMeasures.get(e);if(a===void 0)return console.warn(`[PerformanceMeasure] No start mark found for "${e}". Did you forget to call startMeasure?`),null;performance.measure(i,n,o);const c=s-a.startTime,u=a.extra||r?g(g({},a.extra||{}),r||{}):void 0;return this.activeMeasures.delete(e),g({name:e,duration:c,startTime:a.startTime,endTime:s},u&&{extra:u})}catch(s){return console.error(`[PerformanceMeasure] Failed to end measure "${e}":`,s),null}}}const Mr=new mi;class wi{constructor(){d(this,"extra",{set:(e,r)=>{k.set(e,r)},remove:e=>{k.remove(e)},clear:()=>{k.clear()},get:e=>k.get(e),getAll:()=>k.getAll()});d(this,"measure",{start:(e,r)=>Mr.startMeasure(e,r),end:(e,r)=>Mr.endMeasure(e,r)})}}var yi=Object.defineProperty,Ei=Object.getOwnPropertyDescriptor,ft=(t,e,r,n)=>{for(var o=n>1?void 0:n?Ei(e,r):e,i=t.length-1,s;i>=0;i--)(s=t[i])&&(o=(n?s(e,r,o):s(o))||o);return n&&o&&yi(e,r,o),o};class ${constructor(){throw new Error("This class can not be instantiated.")}static init(e){if(this._tracker){w.warn("MtTrack only need to be initialized once.");return}this._tracker=new $n(e),this._tracker.event.on("beforeInit",()=>nr.init()),this._tracker.event.on("beforeInit",()=>Lr.init()),this._tracker.init()}static async track(e,r){const n=this._tracker.getContext(),o={name:e,mode:"local",trigger:{type:_.MANUAL,_reportParameterSet:new Set(["domain_name","path","parameters"]),_postCheckParameters:[]},filters:[],extra:[]},i=Se(),s={projectId:n.optionManager.get("projectId"),ts:Date.now()},a=await j(o,i,s);r&&(a.properties.extra=g(g({},a.properties.extra),r)),n.reportQueue.push(a)}static async trackError(e,r){var f,h,p,m;const n=this._tracker.getContext();let o,i,s;e instanceof Error?(o=e.message,i=e.stack||"",s=`${window.location.href}:${((h=(f=new Error().stack)==null?void 0:f.split(`
`)[1])==null?void 0:h.trim())||"unknown"}`):(o=e,i=new Error().stack||"",s=`${window.location.href}:${((m=(p=new Error().stack)==null?void 0:p.split(`
`)[1])==null?void 0:m.trim())||"unknown"}`);const a={message:o,stack:i,location:s},c={projectId:n.optionManager.get("projectId"),ts:Date.now()},u=await Rt(a,c);r&&(u.extra=g(g({},u.extra),r)),n.reportQueue.push(u)}static enableAutoReport(){this.autoReportEnabled||(this.autoReportEnabled=!0,this._tracker.register([Xn,ro,lo,go,_o,Lo,Ro,No]))}static getTracker(){return this._tracker}static configureScope(e){const r=new wi;e(r)}}return d($,"_tracker",null),d($,"autoReportEnabled",!1),ft([Ye()],$,"track",1),ft([Ye()],$,"trackError",1),ft([Ye()],$,"enableAutoReport",1),Te.start(),(L.contextOptions.projectId||L.contextOptions.weakProjectId)&&($.init(L.contextOptions),$.enableAutoReport()),$});
